# NyaaGears 自定义物品系统 v2.0

## 更新说明

- v2.0 迁移&更新
    - 为应对ojng对物品component作出的修改，将数据包重写并重命名
    - 扩展了祝福的镶嵌，现在支持物品更多的祝福栏位
    - 扩展了奖池，现在可以为奖池添加任意物品，且可以添加多个奖池
    - 不再依赖特定的交互实体进行抽奖，制作了一个独立的抽奖动画
    - 祝福的镶嵌等操作现在依靠NyaaWorks进行操作（或者管理员手动执行指令操作）
    - 移除了怪物掉落材料的系统，将通过任务系统重新引入
    - 移除了没有卯月的无尽的无尽宝箱
- v1.6 添加小功能
    - 增加了bundle的合成
    - 增加了无尽的无尽宝箱
- v1.5 添加小功能
    - 增加了无限的烤土豆
    - 增加了吃掉可以获得脑袋的苹果
- v1.4
    - 添加了祝福的强化材料，可以用来强化祝福，每个祝福强化至多三次
    - 祝福的强化材料被一并加入抽奖

## 介绍

- 祝福镶嵌
    - 可以将预设的自定义附魔、属性组合直接添加到任意物品上的功能
    - 管理员可以创建用于镶嵌的祝福，祝福被镶嵌后会消耗
    - 包括一套完整的开槽、镶嵌、镶嵌后强化系统
    - 目前需要与 NyaaWorks 联动进行相关操作
- 抽奖系统
    - 用于创建自定义奖池，玩家通过特殊标签的物品使用抽奖
    - 奖池可以添加任何物品，其中祝福被添加至奖池后会为其添加属性值浮动
- 任务系统
    - TBD
- 部分自定义合成
    - TBD

## 操作方法与说明

- 主手持祝福，副手持任意物品，点击NyaaWorks种的特定家具即可镶嵌
    - 每个物品默认可以镶嵌一次祝福
    - 镶嵌不可取下
    - 附魔的叠加规则与原版相同
    - 属性会优先覆盖物品的默认属性，如果物品已存在自定义属性，则会直接相加
- 手持祝福幻晶可以为副手的物品强化
    - 只能强化带有祝福的物品
    - 每个带有祝福的物品可以被强化至多三次
    - 附魔和属性均会直接叠加上去（如果先前为存在自定义属性，则仍会优先覆盖默认属性）
- 手持打开栏位的道具可以为副手物品打开新的祝福栏位
    - 第一个祝福无需打开栏位即可镶嵌

## 物品创建与管理

- 手持自定义物品，使用指令 `/function ng:gems/add_as_gem` 将物品创建为新的祝福
    - 使用指令获取一个带有自定义附魔和属性的原版物品，作为祝福的物品媒介
    - 在祝福上，附魔与属性将被存储，且不会对祝福本身生效
    - 物品原本的 Name 与 Lore 将被保留，额外的lore将会附加在后面
- 手持自定义物品，使用指令 `/function ng:gems/add_as_gem_upgrade` 将物品创建为新的祝福幻晶
    - 使用效果与祝福类似
- 手持任意物品，使用指令 `/function ng:lotto/add_to_lotto` 将物品添加到奖池
    - 修改 `#input_lotto_type` 在计分项 `ng` 的值可以指定奖池编号。如果编号超过已有奖池的最大编号，将创建新的奖池。编号从0开始计算
    - 如果将祝福添加至奖池，抽到该祝福时，祝福上的附魔等级与属性值将会随机出现，最大为其原本的数值，最小为其一半
- 手持任意物品，使用指令 `/function ng:lotto/add_to_lotto_unique` 将物品设置为奖池的独特奖励
    - 独特奖励只能指定一个，且出现的概率固定，可以通过修改 `#input_lotto_uniquechance` 在计分项 `ng` 的值设置。该数值/10000 即为出现的概率
    - 抽奖获得独特奖励时，不再获得普通奖励
    - 如果未设置奖池的独特奖励，则独特奖励不会出现
    - 同样可以修改 `#input_lotto_type` 在计分项 `ng` 的值可以指定奖池编号。
- 手动执行指令操作
    - `/function ng:player/insert_gem` 镶嵌祝福
    - `/function ng:player/insert_gem_upgrade` 使用幻晶强化
    - `/function ng:player/open_slot` 打开新的槽位
    - `/function ng:player/open_slot_first` 打开第一个槽位（用于获取带有空槽位的物品）
    - 获取抽奖物品的模板（奖池#0）`/give @s enchanted_book[minecraft:max_stack_size=10,minecraft:food={saturation:0.0f,nutrition:0,can_always_eat:1b,eat_seconds:12.0f},minecraft:enchantment_glint_override=0b,minecraft:custom_data={ng_lotto_type:0,ng_ticket:1}]`

## 物品标签

- `ng_gem` 祝福宝石
- `ng_gem_upg` 祝福幻晶
- `ng_newgem` 新版祝福和幻晶
- `ng_gem_slot` 开槽宝石
- `ng_inf` 无限的烤土豆
- `ng_head` 大苹果
- `ng_ticket` 抽奖券
- `ng_lotto_type` 抽奖券奖池
- `ng_item` 物品祝福与幻晶计数
- `ng_wishes` 物品祝福
- `ng_slots` 物品祝福栏位